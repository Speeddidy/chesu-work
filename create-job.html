<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Создать вакансию</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap"
      as="style"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <style>
      /* Базовые стили для предотвращения прыжков */
      :root {
        --font-family-base: "Inter", -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans",
          "Helvetica Neue", sans-serif;
      }

      * {
        font-family: var(--font-family-base);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
      }

      /* Фиксируем размеры для всех текстовых элементов */
      .create-job-title,
      .section-title,
      .cj-label,
      .contact-label,
      .contact-desc,
      .contact-item,
      .contact-edit-btn,
      .contact-inline-btn,
      .mini-editor,
      .editor-section,
      .editor-line,
      .mini-editor-hint,
      .multi-select-placeholder,
      .multi-select-tag,
      .multi-select-option,
      .contact-messenger-text,
      .contact-messenger-placeholder {
        font-family: var(--font-family-base);
      }

      /* Добавляем класс для скрытия контента до загрузки шрифтов */
      .fonts-loading {
        visibility: hidden;
      }

      .form-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 32px;
      }

      .form-btn {
        padding: 14px 32px;
        border-radius: 12px;
        font-size: 17px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 1px solid #e2e8f0;
      }

      .save-btn {
        background: #fff;
        color: #222;
      }

      .save-btn:hover {
        background: #f1f5f9;
        border-color: #cbd5e1;
      }

      .save-btn:active {
        background: #e2e8f0;
        border-color: #94a3b8;
      }

      .publish-btn {
        background: #2563eb;
        color: #fff;
        border: none;
      }

      .publish-btn:hover {
        background: #1d4ed8;
      }

      .publish-btn:active {
        background: #1e40af;
      }

      .create-job-steps {
        min-width: 260px;
        max-width: 300px;
        background: none;
        padding: 32px 0 0 0;
        margin-left: 0;
        position: sticky;
        top: 80px;
        height: fit-content;
        z-index: 1;
        transition: top 0.3s ease;
      }

      .main-header {
        position: sticky;
        top: 0;
        z-index: 2;
        transition: transform 0.3s ease;
      }

      /* Добавляем стили для скролла */
      body.scrolled .main-header {
        transform: translateY(-100%);
      }

      body.scrolled .create-job-steps {
        top: 32px;
      }
    </style>
    <script>
      // Предотвращаем прокрутку при обновлении страницы
      if ("scrollRestoration" in history) {
        history.scrollRestoration = "manual";
      }

      // Функция для проверки загрузки шрифтов
      function checkFontsLoaded() {
        if (document.fonts.status === "loaded") {
          document.documentElement.classList.remove("fonts-loading");
        } else {
          document.fonts.ready.then(() => {
            document.documentElement.classList.remove("fonts-loading");
          });
        }
      }

      // Добавляем класс fonts-loading при загрузке страницы
      document.documentElement.classList.add("fonts-loading");

      // Проверяем загрузку шрифтов
      if (document.fonts && document.fonts.status) {
        checkFontsLoaded();
      } else {
        // Fallback для браузеров без поддержки Font Loading API
        window.addEventListener("load", () => {
          document.documentElement.classList.remove("fonts-loading");
        });
      }

      // Обработка скролла для шапки и шагов
      let lastScrollTop = 0;
      const scrollThreshold = 100; // Порог скролла для скрытия шапки

      // Функция для определения видимости элемента
      function isElementInViewport(el) {
        const rect = el.getBoundingClientRect();
        const windowHeight =
          window.innerHeight || document.documentElement.clientHeight;
        const threshold = windowHeight * 0.3; // 30% от высоты окна

        return rect.top <= threshold && rect.bottom >= threshold;
      }

      // Функция обновления состояния шагов
      function updateStepsState() {
        const sections = document.querySelectorAll(".create-job-section");
        const steps = document.querySelectorAll(".step");

        // Находим текущую секцию
        let currentSection = null;
        sections.forEach((section, index) => {
          if (isElementInViewport(section)) {
            currentSection = index;
          }
        });

        // Обновляем состояние шагов
        if (currentSection !== null) {
          steps.forEach((step, index) => {
            if (index === currentSection) {
              step.classList.add("active");
            } else {
              step.classList.remove("active");
            }
          });
        }
      }

      window.addEventListener("scroll", () => {
        const currentScroll =
          window.pageYOffset || document.documentElement.scrollTop;

        if (currentScroll > scrollThreshold) {
          if (currentScroll > lastScrollTop) {
            // Скролл вниз
            document.body.classList.add("scrolled");
          } else {
            // Скролл вверх
            document.body.classList.remove("scrolled");
          }
        } else {
          document.body.classList.remove("scrolled");
        }

        lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;

        // Обновляем состояние шагов при скролле
        updateStepsState();
      });

      // Добавляем плавную прокрутку при клике на шаг
      document.querySelectorAll(".step").forEach((step, index) => {
        step.addEventListener("click", () => {
          const sections = document.querySelectorAll(".create-job-section");
          if (sections[index]) {
            sections[index].scrollIntoView({
              behavior: "smooth",
              block: "start",
            });
          }
        });
      });

      // Инициализация состояния шагов при загрузке
      document.addEventListener("DOMContentLoaded", () => {
        updateStepsState();
      });
    </script>
  </head>
  <body>
    <!-- Шапка -->
    <header id="main-header" class="cursor-header">
      <div class="header-inner">
        <div class="header-left">
          <div class="logo" onclick="window.location.href='index.html'">
            <span>ChesuJob</span>
          </div>
        </div>
        <nav class="header-center">
          <a href="#" class="nav-link">Прайсинг</a>
          <a href="#" class="nav-link">Фичи</a>
          <a href="#" class="nav-link">Для компаний</a>
          <a href="#" class="nav-link">Блог</a>
          <a href="#" class="nav-link">Форум</a>
          <a href="vacancies.html" class="nav-link">Вакансии</a>
        </nav>
        <!-- <div class="header-right">
        <button class="profile-btn" title="Профиль" id="profileBtn"><i class="fa-regular fa-user"></i></button>
        <div class="profile-dropdown" id="profileDropdown">
          <div class="profile-dropdown-header">
            <div class="profile-dropdown-name" id="profileName">Имя Фамилия</div>
            <div class="profile-dropdown-email" id="profileEmail">email@example.com</div>
          </div>
          <div class="profile-dropdown-divider"></div>
          <div class="profile-dropdown-link" id="accountSettings">ACCOUNT SETTINGS</div>
          <div class="profile-dropdown-link logout" id="logoutBtn">
            LOG OUT <span class="profile-dropdown-logout-icon">↗</span>
          </div>
        </div>
        <button class="vacancy-btn" onclick="window.location.href='create-job.html'"><i class="fa-solid fa-plus"></i> <span>Вакансия+</span></button>
      </div> -->
        <div class="header-right">
          <button class="profile-btn" title="Профиль" id="profileBtn">
            <i class="fa-regular fa-user"></i>
          </button>
          <button
            class="vacancy-btn"
            onclick="window.location.href='create-job.html'"
          >
            <span>Создать вакансию</span>
          </button>
        </div>
      </div>
    </header>

    <main class="create-job-main">
      <div class="create-job-container">
        <h1 class="create-job-title">Новая вакансия</h1>
        <form class="create-job-form" onsubmit="return false;">
          <section class="create-job-section">
            <h2 class="section-title">Основная информация</h2>
            <label class="cj-label">Название</label>
            <input
              class="cj-input"
              type="text"
              placeholder="Название вакансии"
            />

            <label class="cj-label">Специализация сотрудника</label>
            <div
              class="cj-input-icon"
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                position: relative;
              "
            >
              <input
                class="cj-input"
                type="text"
                placeholder="Специализация"
                id="specialization-input"
                autocomplete="off"
              />
              <div id="spec-suggestions" class="spec-suggestions"></div>
              <button
                type="button"
                class="cj-icon-menu"
                id="open-specialization-modal"
                tabindex="0"
                aria-label="Выбрать специализацию"
                style="
                  cursor: pointer;
                  background: none;
                  border: none;
                  padding: 0;
                  display: flex;
                  align-items: center;
                "
              >
                <svg
                  width="22"
                  height="22"
                  viewBox="0 0 22 22"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <rect
                    x="4"
                    y="6"
                    width="14"
                    height="2"
                    rx="1"
                    fill="#6B7A89"
                  />
                  <rect
                    x="4"
                    y="10"
                    width="14"
                    height="2"
                    rx="1"
                    fill="#6B7A89"
                  />
                  <rect
                    x="4"
                    y="14"
                    width="14"
                    height="2"
                    rx="1"
                    fill="#6B7A89"
                  />
                </svg>
              </button>
            </div>

            <!-- Модальное окно выбора специализации -->
            <div class="modal-spec" id="modal-spec" style="display: none">
              <div class="modal-spec-content wide">
                <div class="modal-spec-header">
                  <span class="modal-spec-title">Специализация сотрудника</span>
                  <button class="modal-spec-close" id="close-spec-modal">
                    ×
                  </button>
                </div>
                <div class="modal-spec-subtitle">
                  Выберите профессию, а если нет подходящей — наиболее близкую
                  или пункт «Другое»
                </div>
                <div class="modal-spec-search">
                  <svg
                    class="search-icon"
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z"
                      stroke="#6B7A89"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M19 19L14.65 14.65"
                      stroke="#6B7A89"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  <input
                    type="text"
                    placeholder="Поиск"
                    id="spec-search-input"
                  />
                </div>
                <div class="modal-spec-list" id="spec-list">
                  <div class="modal-spec-item" data-key="auto">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Автомобильный бизнес
                  </div>
                  <div class="modal-spec-item" data-key="admin">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Административный персонал
                  </div>
                  <div class="modal-spec-item" data-key="security">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Безопасность
                  </div>
                  <div class="modal-spec-item" data-key="top-mgmt">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Высший и средний менеджмент
                  </div>
                  <div class="modal-spec-item" data-key="extraction">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Добыча сырья
                  </div>
                  <div class="modal-spec-item" data-key="home">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Домашний, обслуживающий персонал
                  </div>
                  <div class="modal-spec-item" data-key="purchase">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Закупки
                  </div>
                  <div class="modal-spec-item" data-key="it">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Информационные технологии
                  </div>
                  <div class="modal-spec-item" data-key="art">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Искусство, развлечения, массмедиа
                  </div>
                  <div class="modal-spec-item" data-key="marketing">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Маркетинг, реклама, PR
                  </div>
                  <div class="modal-spec-item" data-key="medicine">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Медицина, фармацевтика
                  </div>
                  <div class="modal-spec-item" data-key="science">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Наука, образование
                  </div>
                  <div class="modal-spec-item" data-key="sales">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Продажи, обслуживание клиентов
                  </div>
                  <div class="modal-spec-item" data-key="production">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Производство, сервисное обслуживание
                  </div>
                  <div class="modal-spec-item" data-key="worker">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Рабочий персонал
                  </div>
                  <div class="modal-spec-item" data-key="retail">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Розничная торговля
                  </div>
                  <div class="modal-spec-item" data-key="agro">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Сельское хозяйство
                  </div>
                  <div class="modal-spec-item" data-key="sport">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Спортивные клубы, фитнес, салоны красоты
                  </div>
                  <div class="modal-spec-item" data-key="strategy">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Стратегия, инвестиции, консалтинг
                  </div>
                  <div class="modal-spec-item" data-key="insurance">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Страхование
                  </div>
                  <div class="modal-spec-item" data-key="construction">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Строительство, недвижимость
                  </div>
                  <div class="modal-spec-item" data-key="logistics">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Транспорт, логистика, перевозки
                  </div>
                  <div class="modal-spec-item" data-key="tourism">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Туризм, гостиницы, рестораны
                  </div>
                  <div class="modal-spec-item" data-key="hr">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Управление персоналом, тренинги
                  </div>
                  <div class="modal-spec-item" data-key="finance">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Финансы, бухгалтерия
                  </div>
                  <div class="modal-spec-item" data-key="law">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Юристы
                  </div>
                  <div class="modal-spec-item" data-key="other">
                    <span class="modal-spec-arrow">
                      <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M9 6l6 6-6 6"
                          stroke="#B0B8C1"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                    Другое
                  </div>
                  <div id="modal-spec-children-container"></div>
                </div>
                <div class="modal-spec-footer">
                  <button class="modal-spec-cancel" id="spec-cancel">
                    Отменить
                  </button>
                  <button class="modal-spec-choose" id="spec-choose">
                    Выбрать
                  </button>
                </div>
              </div>
            </div>

            <label class="cj-label">Опыт работы</label>
            <div class="cj-btn-group">
              <button type="button" class="cj-btn cj-btn-outline">
                Нет опыта
              </button>
              <button type="button" class="cj-btn cj-btn-outline">
                От 1 года до 3 лет
              </button>
              <button type="button" class="cj-btn cj-btn-outline">
                От 3 до 6 лет
              </button>
              <button type="button" class="cj-btn cj-btn-outline">
                Более 6 лет
              </button>
            </div>

            <div
              class="university-grads-block"
              style="
                margin-top: 24px;
                padding: 24px;
                background: #f1f5f9;
                border-radius: 16px;
              "
            >
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 8px;
                  margin-bottom: 16px;
                "
              >
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M12 14l9-5-9-5-9 5 9 5z"
                    stroke="#2563EB"
                    stroke-width="2"
                  />
                  <path
                    d="M12 14l9-5-9-5-9 5 9 5z"
                    stroke="#2563EB"
                    stroke-width="2"
                  />
                  <path d="M12 14v6" stroke="#2563EB" stroke-width="2" />
                  <path d="M12 20l9-5" stroke="#2563EB" stroke-width="2" />
                  <path d="M12 20l-9-5" stroke="#2563EB" stroke-width="2" />
                </svg>
                <label class="cj-label" style="margin: 0"
                  >Для выпускников и студентов</label
                >
              </div>

              <div class="grads-categories" style="margin-bottom: 20px">
                <div
                  class="cj-label"
                  style="margin-bottom: 8px; color: #64748b"
                >
                  Категория
                </div>
                <div class="cj-btn-group">
                  <button type="button" class="cj-btn cj-btn-outline">
                    Студенты 3-4 курса
                  </button>
                  <button type="button" class="cj-btn cj-btn-outline">
                    Студенты 5-6 курса
                  </button>
                  <button type="button" class="cj-btn cj-btn-outline">
                    Выпускники 2024
                  </button>
                  <button type="button" class="cj-btn cj-btn-outline">
                    Выпускники 2023
                  </button>
                </div>
              </div>

              <div class="grads-options" style="margin-bottom: 20px">
                <div
                  class="cj-label"
                  style="margin-bottom: 8px; color: #64748b"
                >
                  Возможности
                </div>
                <div class="cj-btn-group cj-multiselect">
                  <button type="button" class="cj-btn cj-btn-outline">
                    <span class="cj-check"></span>Стажировка
                  </button>
                  <button type="button" class="cj-btn cj-btn-outline">
                    <span class="cj-check"></span>Программа наставничества
                  </button>
                  <button type="button" class="cj-btn cj-btn-outline">
                    <span class="cj-check"></span>Гибкий график под учебу
                  </button>
                </div>
              </div>

              <div class="grads-benefits">
                <div
                  class="cj-label"
                  style="margin-bottom: 8px; color: #64748b"
                >
                  Преимущества
                </div>
                <div class="cj-btn-group cj-multiselect">
                  <button type="button" class="cj-btn cj-btn-outline">
                    <span class="cj-check"></span>Официальное трудоустройство
                  </button>
                  <button type="button" class="cj-btn cj-btn-outline">
                    <span class="cj-check"></span>Карьерный рост
                  </button>
                  <button type="button" class="cj-btn cj-btn-outline">
                    <span class="cj-check"></span>Молодой коллектив
                  </button>
                </div>
              </div>
            </div>
          </section>

          <section class="create-job-section">
            <h2 class="section-title">Условия работы</h2>
            <label class="cj-label">Тип занятости</label>
            <div class="cj-btn-group">
              <button type="button" class="cj-btn cj-btn-outline">
                Полная
              </button>
              <button type="button" class="cj-btn cj-btn-outline">
                Частичная
              </button>
              <button type="button" class="cj-btn cj-btn-outline">
                Проект или разовое задание
              </button>
              <button type="button" class="cj-btn cj-btn-outline">Вахта</button>
            </div>

            <label class="cj-label">Подработка</label>
            <div class="cj-btn-group">
              <button type="button" class="cj-btn cj-btn-outline">Да</button>
              <button type="button" class="cj-btn cj-btn-outline">Нет</button>
            </div>

            <label class="cj-label">Формат работы</label>
            <div class="cj-btn-group cj-multiselect" id="work-format-group">
              <button type="button" class="cj-btn cj-btn-outline">
                <span class="cj-check"></span>На месте работодателя
              </button>
              <button type="button" class="cj-btn cj-btn-outline">
                <span class="cj-check"></span>Удалённо
              </button>
              <button type="button" class="cj-btn cj-btn-outline">
                <span class="cj-check"></span>Гибрид
              </button>
              <button type="button" class="cj-btn cj-btn-outline">
                <span class="cj-check"></span>Разъездной
              </button>
            </div>
          </section>

          <!-- Новый блок: Формат найма -->
          <section class="create-job-section">
            <h2 class="section-title">Формат найма</h2>
            <div class="hire-format-block">
              <div class="hire-format-row">
                <div>
                  <div class="hire-format-title">Стажировка</div>
                  <div class="hire-format-desc">
                    Если ищете стажёра на время, а не на постоянную работу
                  </div>
                </div>
                <label class="switch">
                  <input type="checkbox" id="internship-switch" />
                  <span class="slider round"></span>
                </label>
              </div>
              <div class="hire-format-row">
                <div>
                  <div class="hire-format-title">Можно оформить временно</div>
                  <div class="hire-format-desc">
                    По совместительству или ГПХ: подряд, ИП, самозанятость
                  </div>
                </div>
                <label class="switch">
                  <input type="checkbox" id="temporary-switch" />
                  <span class="slider round"></span>
                </label>
              </div>
            </div>
          </section>

          <!-- Новый блок: График и часы работы -->
          <section class="create-job-section">
            <h2 class="section-title">График и часы работы</h2>
            <label class="cj-label"
              >График работы
              <span title="Что это?" style="cursor: help; color: #b0b8c1"
                >&#9432;</span
              ></label
            >
            <div class="multi-select-container" id="schedule-multiselect">
              <div
                class="multi-select-input"
                id="schedule-multiselect-input"
                tabindex="0"
              ></div>
              <span class="multi-select-arrow" id="schedule-multiselect-arrow">
                <svg
                  width="28"
                  height="28"
                  viewBox="0 0 28 28"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M7 11L14 18L21 11"
                    stroke="#B0B8C1"
                    stroke-width="2.2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </span>
              <div
                class="multi-select-dropdown"
                id="schedule-multiselect-dropdown"
              ></div>
            </div>
            <label class="cj-label" style="margin-top: 16px"
              >Рабочие часы в день</label
            >
            <div class="multi-select-container" id="hours-multiselect">
              <div
                class="multi-select-input"
                id="hours-multiselect-input"
                tabindex="0"
              ></div>
              <span class="multi-select-arrow" id="hours-multiselect-arrow">
                <svg
                  width="28"
                  height="28"
                  viewBox="0 0 28 28"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M7 11L14 18L21 11"
                    stroke="#B0B8C1"
                    stroke-width="2.2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </span>
              <div
                class="multi-select-dropdown"
                id="hours-multiselect-dropdown"
              ></div>
            </div>
          </section>

          <!-- Новый блок: Адрес работы и город публикации -->
          <section class="create-job-section">
            <h2 class="section-title">Адрес работы и город публикации</h2>
            <div class="job-address-block">
              <div class="job-city-label">Город публикации</div>
              <div class="job-city-desc">
                Вакансию увидят люди, которые там живут или готовы туда
                переехать
              </div>
              <div class="multi-select-container" id="city-multiselect">
                <div
                  class="multi-select-input"
                  id="city-multiselect-input"
                  tabindex="0"
                ></div>
                <span class="multi-select-arrow" id="city-multiselect-arrow">
                  <svg
                    width="28"
                    height="28"
                    viewBox="0 0 28 28"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7 11L14 18L21 11"
                      stroke="#B0B8C1"
                      stroke-width="2.2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </span>
                <div
                  class="multi-select-dropdown"
                  id="city-multiselect-dropdown"
                ></div>
              </div>

              <div class="job-address-label">
                Адрес, где будет работать сотрудник
              </div>
              <div class="job-address-desc">
                Если работа разъездная, можно указать адрес офиса
              </div>
              <div class="job-address-radio-group">
                <label class="job-radio">
                  <input type="radio" name="address-type" checked />
                  <span class="job-radio-custom"></span>
                  Не указывать
                </label>
                <label class="job-radio">
                  <input type="radio" name="address-type" />
                  <span class="job-radio-custom"></span>
                  Указать
                </label>
                <div
                  class="address-search-container"
                  id="address-search-block"
                  style="display: none"
                >
                  <input
                    class="address-search-input"
                    type="text"
                    placeholder="Поиск по адресам"
                  />
                  <span class="address-search-icon">
                    <svg width="20" height="20" fill="none" viewBox="0 0 20 20">
                      <circle
                        cx="9"
                        cy="9"
                        r="7"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <path
                        d="M17 17L13.5 13.5"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                      />
                    </svg>
                  </span>
                  <ul class="address-suggestions" id="address-suggestions"></ul>
                  <button
                    type="button"
                    class="map-select-btn"
                    onclick="openMapSelectModal()"
                  >
                    Указать на карте
                  </button>
                </div>

                <!-- Map Modal -->
                <div id="map-select-modal" class="modal">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h3>Выберите адрес на карте</h3>
                      <button
                        class="close-modal"
                        onclick="closeModal('map-select-modal')"
                      >
                        ×
                      </button>
                    </div>
                    <div
                      id="map-select"
                      style="height: 400px; width: 100%"
                    ></div>
                    <div class="modal-footer">
                      <button
                        class="save-location-btn"
                        onclick="saveSelectedLocation()"
                      >
                        Сохранить
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section class="create-job-section">
            <h2 class="section-title">Оплата работы</h2>
            <div class="job-salary-block">
              <div class="job-salary-row">
                <input
                  class="cj-input job-salary-input"
                  type="text"
                  placeholder="от"
                />
                <input
                  class="cj-input job-salary-input"
                  type="text"
                  placeholder="до"
                />
                <div class="custom-dropdown currency-dropdown">
                  <div class="dropdown-selected" id="currency-selected">
                    ₽
                    <span class="dropdown-arrow"
                      ><svg width="24" height="24" viewBox="0 0 24 24">
                        <path
                          d="M7 10l5 5 5-5"
                          stroke="#b5c7e7"
                          stroke-width="2.2"
                          fill="none"
                          stroke-linecap="round"
                        /></svg
                    ></span>
                  </div>
                  <div class="dropdown-list" id="currency-list">
                    <div class="dropdown-option active">₽</div>
                    <div class="dropdown-option">$</div>
                    <div class="dropdown-option">€</div>
                  </div>
                </div>
                <div class="custom-dropdown period-dropdown">
                  <div class="dropdown-selected" id="period-selected">
                    За месяц
                    <span class="dropdown-arrow"
                      ><svg width="24" height="24" viewBox="0 0 24 24">
                        <path
                          d="M7 10l5 5 5-5"
                          stroke="#b5c7e7"
                          stroke-width="2.2"
                          fill="none"
                          stroke-linecap="round"
                        /></svg
                    ></span>
                  </div>
                  <div class="dropdown-list" id="period-list">
                    <div class="dropdown-option active">За месяц</div>
                    <div class="dropdown-option">За день</div>
                    <div class="dropdown-option">За час</div>
                    <div class="dropdown-option">За проект</div>
                  </div>
                </div>
              </div>
              <div class="job-salary-type-group">
                <button type="button" class="job-salary-type active">
                  До вычета налогов
                </button>
                <button type="button" class="job-salary-type">На руки</button>
              </div>
              <div class="job-salary-freq-label">Частота выплат</div>
              <div class="job-salary-freq-group">
                <button type="button" class="job-salary-freq">Ежедневно</button>
                <button type="button" class="job-salary-freq">
                  Раз в неделю
                </button>
                <button type="button" class="job-salary-freq">
                  Два раза в месяц
                </button>
                <button type="button" class="job-salary-freq">
                  Раз в месяц
                </button>
                <button type="button" class="job-salary-freq">За проект</button>
              </div>
            </div>
          </section>
          <!-- Перемещаю блок 'Описание вакансии' в самый конец -->
          <section class="create-job-section">
            <h2 class="section-title">Описание вакансии</h2>
            <div class="mini-editor-block">
              <div
                id="mini-editor"
                class="mini-editor"
                contenteditable="true"
                spellcheck="false"
              >
                <div
                  class="editor-section"
                  data-type="header"
                  contenteditable="false"
                  style="font-weight: bold"
                >
                  Обязанности:
                </div>
                <div class="editor-line" contenteditable="true">—</div>
                <div class="editor-line" contenteditable="true">—</div>
                <div
                  class="editor-section"
                  data-type="header"
                  contenteditable="false"
                  style="font-weight: bold; margin-top: 12px"
                >
                  Требования:
                </div>
                <div class="editor-line" contenteditable="true">—</div>
                <div class="editor-line" contenteditable="true">—</div>
                <div
                  class="editor-section"
                  data-type="header"
                  contenteditable="false"
                  style="font-weight: bold; margin-top: 12px"
                >
                  Условия:
                </div>
                <div class="editor-line" contenteditable="true">—</div>
                <div class="editor-line" contenteditable="true">—</div>
              </div>
              <div class="mini-editor-hint">
                Заполните пункты. Заголовки нельзя удалить. Enter — новая строка
                с дефисом.
              </div>
            </div>
          </section>
          <!-- Блок навыков -->
          <section class="create-job-section">
            <h2 class="section-title">Навыки</h2>
            <div class="mini-editor-hint" style="margin-bottom: 8px">
              Укажите навыки — мы будем рекомендовать вакансию подходящим
              специалистам.
            </div>
            <div class="multi-select-container" id="skills-multiselect">
              <div
                class="multi-select-input"
                id="skills-multiselect-input"
                tabindex="0"
              ></div>
              <span class="multi-select-arrow" id="skills-multiselect-arrow">
                <svg
                  width="28"
                  height="28"
                  viewBox="0 0 28 28"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M7 11L14 18L21 11"
                    stroke="#B0B8C1"
                    stroke-width="2.2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </span>
              <div
                class="multi-select-dropdown"
                id="skills-multiselect-dropdown"
              ></div>
            </div>
          </section>
          <!-- Блок способов связи -->
          <section class="create-job-section">
            <h2 class="section-title">Способы связи</h2>
            <div class="contact-card" id="contact-card-block">
              <div class="contact-label">Контакты в вакансии</div>
              <div class="contact-desc">
                Соискатели увидят их и смогут позвонить или написать
              </div>
              <hr class="contact-hr" />
              <div class="contact-info" id="contact-info-block">
                <!-- Контент будет рендериться JS -->
              </div>
              <div id="contact-actions-block" style="margin-top: 16px"></div>
            </div>
          </section>
          <div
            class="form-buttons"
            style="
              display: flex;
              justify-content: space-between;
              margin-top: 32px;
            "
          >
            <button class="form-btn save-btn" type="button">Сохранить</button>
            <button class="form-btn publish-btn" type="button">
              Опубликовать
            </button>
          </div>
        </form>
      </div>
      <aside class="create-job-steps">
        <div class="steps-title">Шаги</div>
        <ol class="steps-list">
          <li class="step active">Основная информация</li>
          <li class="step">Настройки вакансии</li>
          <li class="step">Публикация вакансии</li>
        </ol>
      </aside>
    </main>

    <!-- Футер -->
    <footer>
      <p>© 2025 Работа в Грозном. Все права защищены.</p>
    </footer>

    <style>
      .mini-editor-block {
        margin-top: 10px;
      }
      .mini-editor {
        min-height: 40px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        padding: 6px 8px 6px 8px;
        font-size: 16px;
        outline: none;
        background: #fff;
        line-height: 1.1;
        font-family: inherit;
        margin-bottom: 8px;
        white-space: pre-wrap;
      }
      .editor-section {
        user-select: none;
        pointer-events: none;
        font-weight: bold;
        margin: 0 0 2px 0;
        padding: 0;
        line-height: 1.1;
      }
      .editor-line[contenteditable="true"] {
        min-height: 12px;
        margin: 0;
        padding: 0;
        line-height: 1.1;
        font-weight: normal;
      }
      .editor-line[contenteditable="true"]:focus {
        outline: none;
        background: #f1f5f9;
      }
      .mini-editor-hint {
        color: #64748b;
        font-size: 13px;
        margin-top: 2px;
      }
      /* ... существующие стили ... */
      .multi-select-container {
        position: relative;
        width: 100%;
        margin-bottom: 8px;
      }
      .multi-select-input {
        min-height: 38px;
        border: 1px solid #d1d5db;
        border-radius: 10px;
        padding: 8px 16px;
        background: #fafbfc;
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        gap: 6px;
        cursor: pointer;
        font-size: 15px;
      }
      .multi-select-placeholder {
        color: #b0b8c1;
        font-size: 15px;
      }
      .multi-select-tag {
        background: #e0e7ef;
        border-radius: 6px;
        padding: 2px 10px;
        font-size: 15px;
        color: #222;
        display: flex;
        align-items: center;
        gap: 4px;
      }
      .multi-select-tag-close {
        margin-left: 4px;
        cursor: pointer;
        color: #b0b8c1;
        font-size: 16px;
      }
      .multi-select-arrow {
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
      }
      .multi-select-dropdown {
        display: none;
        position: absolute;
        left: 0;
        top: 110%;
        width: 100%;
        background: #fff;
        border: 1px solid #d1d5db;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        z-index: 10;
        max-height: 220px;
        overflow-y: auto;
        padding: 6px 0;
      }
      .multi-select-option {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 6px 18px;
        cursor: pointer;
        font-size: 15px;
        transition: background 0.15s;
      }
      .multi-select-option.selected {
        background: #e0e7ef;
        color: #2563eb;
      }
      .multi-select-option:hover {
        background: #f1f5f9;
      }
      .multi-select-search {
        width: 100%;
        border: none;
        outline: none;
        font-size: 15px;
        padding: 8px 16px 8px 16px;
        margin-bottom: 4px;
        background: #f6f8fa;
        border-radius: 8px;
        box-sizing: border-box;
      }
      /* ... существующие стили ... */
      .multi-select-input input.multi-select-search {
        border: none;
        background: transparent;
        outline: none;
        box-shadow: none;
        min-width: 120px;
        flex: 1;
        font-size: 15px;
        padding: 0;
        margin: 0;
        height: 28px;
      }
      .contact-card {
        border: 1px solid #e2e8f0;
        border-radius: 16px;
        background: #fff;
        padding: 20px 24px 16px 24px;
        margin-top: 18px;
        margin-bottom: 18px;
        max-width: 480px;
        box-shadow: none;
      }
      .contact-label {
        font-weight: 600;
        font-size: 17px;
        margin-bottom: 2px;
      }
      .contact-desc {
        color: #94a3b8;
        font-size: 14px;
        margin-bottom: 10px;
      }
      .contact-hr {
        border: none;
        border-top: 1px solid #e2e8f0;
        margin: 10px 0 16px 0;
      }
      .contact-info {
        margin-bottom: 18px;
      }
      .contact-item {
        font-size: 17px;
        color: #222;
        margin-bottom: 6px;
        word-break: break-all;
      }
      .contact-edit-btn {
        width: 100%;
        background: #f1f5f9;
        color: #222;
        font-weight: 600;
        font-size: 17px;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 14px 0;
        cursor: pointer;
        margin-top: 2px;
        transition: all 0.2s ease;
      }
      .contact-edit-btn:hover {
        background: #e2e8f0;
        border-color: #cbd5e1;
      }
      .contact-edit-btn:active {
        background: #cbd5e1;
        border-color: #94a3b8;
      }
      /* ... существующие стили ... */
      .contact-add-link {
        color: #2563eb;
        font-size: 15px;
        cursor: pointer;
        margin-left: 0;
        margin-bottom: 4px;
        display: inline-block;
        background: none;
        border: none;
        padding: 0;
      }
      .contact-add-link:hover {
        text-decoration: underline;
      }
      .contact-edit-input {
        font-size: 15px;
        padding: 2px 8px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        margin-right: 6px;
        margin-bottom: 2px;
      }
      .contact-save-btn {
        font-size: 15px;
        color: #2563eb;
        background: none;
        border: none;
        cursor: pointer;
        padding: 0 4px;
        margin-left: 2px;
      }
      .contact-save-btn:hover {
        text-decoration: underline;
      }
      /* ... существующие стили ... */
      .contact-messenger {
        display: flex;
        align-items: center;
        gap: 8px;
        border-radius: 10px;
        padding: 7px 16px 7px 10px;
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 7px;
        margin-top: 2px;
        width: fit-content;
        min-width: 120px;
        max-width: 320px;
        box-shadow: 0 1px 4px 0 rgba(34, 158, 217, 0.04);
        cursor: pointer;
        transition: box-shadow 0.15s, border 0.15s;
      }
      .contact-telegram {
        background: transparent;
        color: #229ed9;
        border: 1.5px solid #b6e0fe;
      }
      .contact-whatsapp {
        background: transparent;
        color: #25d366;
        border: 1.5px solid #b6f7c1;
      }
      .contact-messenger-icon {
        display: flex;
        align-items: center;
        margin-right: 2px;
      }
      .contact-messenger-text {
        font-size: 16px;
        font-weight: 500;
        color: inherit;
        word-break: break-all;
      }
      .contact-messenger-placeholder {
        color: #b0b8c1;
        font-size: 16px;
        font-weight: 400;
        font-style: italic;
      }
      .contact-messenger-edit {
        border: none;
        background: transparent;
        font-size: 16px;
        font-weight: 500;
        color: #222;
        outline: none;
        width: 140px;
        margin-left: 2px;
      }
      /* ... существующие стили ... */
      .contact-edit-label {
        display: block;
        color: #64748b;
        font-size: 15px;
        font-weight: 500;
        margin-bottom: 8px;
      }
      .contact-edit-input {
        width: 100%;
        font-size: 16px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        padding: 8px 12px;
        margin-top: 4px;
        margin-bottom: 8px;
        background: #fafbfc;
        color: #222;
        font-weight: 500;
        outline: none;
        transition: border 0.2s;
      }
      .contact-edit-input:focus {
        border-color: #2563eb;
        background: #fff;
      }
      .contact-edit-row {
        display: flex;
        gap: 12px;
        margin-bottom: 8px;
      }
      .contact-messengers-row {
        display: flex;
        gap: 12px;
        align-items: center;
        margin-bottom: 8px;
      }
      #add-phone2-btn {
        margin-bottom: 10px;
        margin-top: 0;
      }
      /* ... существующие стили ... */
      .contact-card input[type="text"],
      .contact-card input[type="email"] {
        font-size: 16px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        padding: 6px 10px;
        margin: 2px 0 6px 0;
        background: #fafbfc;
        color: #222;
        font-weight: 500;
        outline: none;
        width: 100%;
        transition: border 0.2s;
      }
      .contact-card input[type="text"]:focus,
      .contact-card input[type="email"]:focus {
        border-color: #2563eb;
        background: #fff;
      }
      .contact-inline-row {
        display: flex;
        gap: 12px;
        align-items: flex-start;
        margin-bottom: 8px;
      }
      .contact-messengers-row {
        display: flex;
        gap: 12px;
        align-items: center;
        margin-bottom: 8px;
      }
      .contact-messenger input {
        background: transparent;
        border: none;
        outline: none;
        font-size: 16px;
        font-weight: 500;
        color: #222;
        width: 120px;
        margin-left: 2px;
      }
      .contact-messenger input::placeholder {
        color: #b0b8c1;
        font-style: italic;
      }
      .contact-inline-actions {
        display: flex;
        gap: 12px;
        margin-top: 12px;
      }
      .contact-inline-btn {
        border: 1px solid #e2e8f0;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        padding: 10px 0;
        width: 140px;
        cursor: pointer;
        background: #2563eb;
        color: #fff;
        transition: all 0.2s ease;
      }
      .contact-inline-btn:hover {
        background: #1d4ed8;
        border-color: #1e40af;
      }
      .contact-inline-btn:active {
        background: #1e40af;
        border-color: #1e3a8a;
      }
      .contact-inline-btn.cancel {
        background: #f1f5f9;
        color: #222;
        border: 1px solid #e2e8f0;
      }
      .contact-inline-btn.cancel:hover {
        background: #e2e8f0;
        border-color: #cbd5e1;
      }
      .contact-inline-btn.cancel:active {
        background: #cbd5e1;
        border-color: #94a3b8;
      }
      .contact-add-link {
        margin-bottom: 0;
      }
    </style>

    <script>
      // Выделение выбранной кнопки в каждой группе (одиночный выбор)
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".cj-btn-group").forEach((group) => {
          // Для мультивыбора (формат работы)
          if (group.classList.contains("cj-multiselect")) {
            group.addEventListener("click", function (e) {
              if (
                e.target.classList.contains("cj-btn") ||
                e.target.closest(".cj-btn")
              ) {
                const btn = e.target.classList.contains("cj-btn")
                  ? e.target
                  : e.target.closest(".cj-btn");
                btn.classList.toggle("active");
              }
            });
          } else {
            // Обычный одиночный выбор
            group.addEventListener("click", function (e) {
              if (e.target.classList.contains("cj-btn")) {
                group
                  .querySelectorAll(".cj-btn")
                  .forEach((btn) => btn.classList.remove("active"));
                e.target.classList.add("active");
              }
            });
          }
        });
      });

      // Открытие/закрытие модального окна специализации и подсписок под категорией
      document.addEventListener("DOMContentLoaded", function () {
        const openBtn = document.getElementById("open-specialization-modal");
        const modal = document.getElementById("modal-spec");
        const closeBtn = document.getElementById("close-spec-modal");
        const cancelBtn = document.getElementById("spec-cancel");
        const chooseBtn = document.getElementById("spec-choose");
        const input = document.getElementById("specialization-input");
        let selectedSpec = "";
        let openedKeys = new Set();
        const professions = {
          auto: [
            "Автомойщик",
            "Автослесарь, автомеханик",
            "Мастер-приемщик",
            "Менеджер по продажам, менеджер по работе с клиентами",
            "Специалист по гарантийному обслуживанию",
            "Специалист по запчастям",
            "Технический консультант",
          ],
          admin: [
            "Администратор",
            "Делопроизводитель, архивариус",
            "Курьер",
            "Менеджер/руководитель АХО",
            "Оператор ПК, оператор базы данных",
            "Офис-менеджер",
            "Переводчик",
            "Секретарь, помощник руководителя, ассистент",
            "Специалист по кадрам",
            "Специалист по документообороту",
          ],
          security: [
            "Военнослужащий",
            "Охранник",
            "Полицейский",
            "Специалист по информационной безопасности",
            "Специалист по охране труда",
            "Специалист по пожарной безопасности",
          ],
          "top-mgmt": [
            "Генеральный директор",
            "Директор по развитию",
            "Директор по персоналу",
            "Директор по продажам",
            "Директор по производству",
            "Финансовый директор",
            "Технический директор",
          ],
          extraction: [
            "Геолог",
            "Горный инженер",
            "Машинист горных выемочных машин",
            "Машинист экскаватора",
            "Специалист по бурению",
            "Специалист по добыче нефти и газа",
          ],
          home: [
            "Дворецкий",
            "Домработница",
            "Няня",
            "Повар",
            "Садовник",
            "Сиделка",
            "Уборщица",
          ],
          purchase: [
            "Закупщик",
            "Логист",
            "Менеджер по закупкам",
            "Специалист по тендерам",
            "Специалист по снабжению",
            "Специалист по таможенному оформлению",
          ],
          it: [
            "Backend-разработчик",
            "Frontend-разработчик",
            "DevOps-инженер",
            "QA-инженер",
            "Системный администратор",
            "Специалист по информационной безопасности",
            "Технический писатель",
            "UI/UX дизайнер",
          ],
          art: [
            "Актер",
            "Видеооператор",
            "Дизайнер",
            "Журналист",
            "Музыкант",
            "Фотограф",
            "Художник",
          ],
          marketing: [
            "PR-менеджер",
            "SMM-специалист",
            "Бренд-менеджер",
            "Копирайтер",
            "Маркетолог",
            "Медиапланер",
            "Специалист по контекстной рекламе",
          ],
          medicine: [
            "Врач",
            "Медицинская сестра",
            "Провизор",
            "Стоматолог",
            "Фармацевт",
            "Фельдшер",
          ],
          science: [
            "Биолог",
            "Инженер-исследователь",
            "Лаборант",
            "Преподаватель",
            "Учитель",
            "Химик",
          ],
          sales: [
            "Менеджер по продажам",
            "Продавец-консультант",
            "Специалист по работе с клиентами",
            "Торговый представитель",
          ],
          production: [
            "Инженер-конструктор",
            "Инженер-технолог",
            "Мастер производственного участка",
            "Наладчик оборудования",
            "Оператор станков с ЧПУ",
            "Слесарь-сборщик",
          ],
          worker: [
            "Водитель",
            "Грузчик",
            "Кладовщик",
            "Комплектовщик",
            "Оператор производственной линии",
            "Упаковщик",
          ],
          retail: [
            "Администратор магазина",
            "Кассир",
            "Мерчендайзер",
            "Продавец",
            "Специалист по выкладке товара",
          ],
          agro: [
            "Агроном",
            "Ветеринар",
            "Зоотехник",
            "Механизатор",
            "Оператор животноводческих комплексов",
            "Специалист по растениеводству",
          ],
          sport: [
            "Администратор фитнес-клуба",
            "Инструктор по фитнесу",
            "Массажист",
            "Парикмахер",
            "Стилист",
            "Тренер",
          ],
          strategy: [
            "Аналитик",
            "Бизнес-консультант",
            "Инвестиционный аналитик",
            "Стратег",
            "Финансовый аналитик",
          ],
          insurance: [
            "Страховой агент",
            "Андеррайтер",
            "Специалист по урегулированию убытков",
            "Актуарий",
            "Оценщик рисков",
          ],
          construction: [
            "Инженер ПТО",
            "Прораб",
            "Архитектор",
            "Риелтор",
            "Менеджер по продажам недвижимости",
            "Сметчик",
          ],
          logistics: [
            "Логист",
            "Водитель-экспедитор",
            "Диспетчер",
            "Менеджер по ВЭД",
            "Специалист по таможенному оформлению",
          ],
          tourism: [
            "Администратор гостиницы",
            "Менеджер по туризму",
            "Официант",
            "Повар",
            "Гид",
            "Бармен",
          ],
          hr: [
            "HR-менеджер",
            "Рекрутер",
            "Бизнес-тренер",
            "Специалист по кадровому делопроизводству",
            "Директор по персоналу",
          ],
          finance: [
            "Бухгалтер",
            "Финансовый аналитик",
            "Аудитор",
            "Казначей",
            "Экономист",
            "Главный бухгалтер",
          ],
          law: [
            "Юрисконсульт",
            "Адвокат",
            "Нотариус",
            "Помощник юриста",
            "Судебный представитель",
          ],
          other: ["Другое"],
        };
        const specInput = document.getElementById("specialization-input");
        const specSuggestions = document.getElementById("spec-suggestions");
        specInput.addEventListener("input", function () {
          const value = this.value.trim().toLowerCase();
          specSuggestions.innerHTML = "";
          if (!value) {
            specSuggestions.style.display = "none";
            return;
          }
          let matches = [];
          Object.values(professions).forEach((arr) => {
            arr.forEach((prof) => {
              if (prof.toLowerCase().includes(value)) {
                matches.push(prof);
              }
            });
          });
          matches = [...new Set(matches)].slice(0, 8); // максимум 8 уникальных
          if (matches.length === 0) {
            specSuggestions.style.display = "none";
            return;
          }
          matches.forEach((prof) => {
            const div = document.createElement("div");
            div.className = "spec-suggestion-item";
            div.textContent = prof;
            div.onclick = function () {
              specInput.value = prof;
              selectedSpec = prof;
              specSuggestions.style.display = "none";
            };
            specSuggestions.appendChild(div);
          });
          specSuggestions.style.display = "block";
        });
        specInput.addEventListener("blur", function () {
          setTimeout(() => {
            specSuggestions.style.display = "none";
          }, 150);
        });
        openBtn.addEventListener("click", () => {
          modal.style.display = "flex";
          document.body.style.overflow = "hidden";
        });
        openBtn.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            modal.style.display = "flex";
            document.body.style.overflow = "hidden";
          }
        });
        closeBtn.addEventListener("click", () => {
          modal.style.display = "none";
          document.body.style.overflow = "";
        });
        cancelBtn.addEventListener("click", () => {
          modal.style.display = "none";
          document.body.style.overflow = "";
        });
        // Поиск по специализациям и профессиям
        const specSearchInput = document.getElementById("spec-search-input");
        specSearchInput.addEventListener("focus", function () {
          document.getElementById("modal-spec").style.display = "flex";
          document.body.style.overflow = "hidden";
        });
        specSearchInput.addEventListener("click", function () {
          document.getElementById("modal-spec").style.display = "flex";
          document.body.style.overflow = "hidden";
        });

        // Add search functionality
        specSearchInput.addEventListener("input", function () {
          const searchText = this.value.toLowerCase();
          const specList = document.getElementById("spec-list");
          const specItems = specList.querySelectorAll(".modal-spec-item");

          // Удаляем все существующие подсписки
          document
            .querySelectorAll(".modal-spec-children-block")
            .forEach((block) => block.remove());

          // Скрываем все категории
          specItems.forEach((item) => {
            item.style.display = "none";
          });

          if (searchText) {
            // Создаем контейнер для результатов поиска
            const searchResults = document.createElement("div");
            searchResults.className = "modal-spec-children-block";
            searchResults.style.marginTop = "10px";
            searchResults.style.paddingLeft = "0";
            searchResults.style.marginLeft = "0";

            // Ищем совпадения во всех профессиях
            let hasResults = false;
            Object.entries(professions).forEach(([categoryKey, profs]) => {
              profs.forEach((prof) => {
                if (prof.toLowerCase().includes(searchText)) {
                  hasResults = true;
                  const label = document.createElement("label");
                  label.className = "job-radio";
                  label.innerHTML = `<input type="radio" name="spec-profession-search" value="${prof}" ${
                    selectedSpec === prof ? "checked" : ""
                  }><span class="job-radio-custom"></span> ${prof}`;
                  searchResults.appendChild(label);
                }
              });
            });

            if (hasResults) {
              // Добавляем результаты поиска в начало списка
              specList.insertBefore(searchResults, specList.firstChild);

              // Навешиваем обработчики на radio
              searchResults
                .querySelectorAll("input[type=radio]")
                .forEach((radio) => {
                  radio.addEventListener("change", function () {
                    selectedSpec = this.value;
                  });
                });
            }
          } else {
            // Если поиск пустой, показываем все категории
            specItems.forEach((item) => {
              item.style.display = "flex";
            });
          }
        });

        // Подсписок под категорией
        document.querySelectorAll(".modal-spec-item").forEach((item) => {
          item.addEventListener("click", function (e) {
            e.stopPropagation();
            const key = this.getAttribute("data-key");

            if (openedKeys.has(key)) {
              // Закрываем подсписок текущей категории
              const currentBlock = this.nextElementSibling;
              if (
                currentBlock &&
                currentBlock.classList.contains("modal-spec-children-block")
              ) {
                currentBlock.remove();
              }
              openedKeys.delete(key);
              this.classList.remove("open");
              this.querySelector(".modal-spec-arrow svg").style.transform =
                "rotate(0deg)";
              return;
            }

            // Открываем новый подсписок
            openedKeys.add(key);
            this.classList.add("open");
            this.querySelector(".modal-spec-arrow svg").style.transform =
              "rotate(90deg)";

            // Создаем новый подсписок
            if (professions[key]) {
              const childrenBlock = document.createElement("div");
              childrenBlock.className = "modal-spec-children-block";
              childrenBlock.innerHTML = renderSpecChildrenBlock(
                professions[key],
                selectedSpec
              );
              this.after(childrenBlock);
              // Навешиваем обработчик на radio
              childrenBlock
                .querySelectorAll("input[type=radio]")
                .forEach((radio) => {
                  radio.addEventListener("change", function () {
                    document
                      .querySelectorAll('input[name="spec-profession"]')
                      .forEach((r) => {
                        if (r !== this) r.checked = false;
                      });
                    selectedSpec = this.value;
                  });
                });
            }
          });
        });

        // Обработчик кнопки "Выбрать"
        chooseBtn.addEventListener("click", function (e) {
          e.preventDefault();
          if (selectedSpec) {
            const specInput = document.getElementById("specialization-input");
            specInput.value = selectedSpec;
            console.log("Selected specialization:", selectedSpec);
          }
          modal.style.display = "none";
          document.body.style.overflow = "";
        });

        // Предотвращаем отправку формы при нажатии Enter
        document
          .querySelector(".create-job-form")
          .addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              e.preventDefault();
            }
          });
      });

      // --- МУЛЬТИСЕЛЕКТ ДЛЯ ГРАФИКА РАБОТЫ ---
      const scheduleOptions3 = [
        "6/1",
        "5/2",
        "4/4",
        "4/3",
        "4/2",
        "2/2",
        "2/1",
        "1/3",
        "По выходным",
        "Свободный",
        "Другое",
      ];
      let selectedSchedules3 = [];
      const multiSelect = document.getElementById("schedule-multiselect");
      const multiSelectInput = document.getElementById(
        "schedule-multiselect-input"
      );
      const multiSelectDropdown = document.getElementById(
        "schedule-multiselect-dropdown"
      );
      const multiSelectArrow = document.getElementById(
        "schedule-multiselect-arrow"
      );
      const arrowDown = document.getElementById("arrow-down");
      const arrowUp = document.getElementById("arrow-up");

      function renderMultiSelectInput() {
        multiSelectInput.innerHTML = "";
        selectedSchedules3.forEach((val) => {
          const tag = document.createElement("span");
          tag.className = "multi-select-tag";
          tag.textContent = val;
          const close = document.createElement("span");
          close.className = "multi-select-tag-close";
          close.innerHTML = "&times;";
          close.onclick = function (e) {
            e.stopPropagation();
            selectedSchedules3 = selectedSchedules3.filter((v) => v !== val);
            renderMultiSelectInput();
            renderMultiSelectDropdown();
          };
          tag.appendChild(close);
          multiSelectInput.appendChild(tag);
        });
        if (selectedSchedules3.length === 0) {
          const placeholder = document.createElement("span");
          placeholder.className = "multi-select-placeholder";
          placeholder.textContent = "Выберите из списка";
          multiSelectInput.appendChild(placeholder);
        }
      }

      function renderMultiSelectDropdown() {
        multiSelectDropdown.innerHTML = "";
        scheduleOptions3.forEach((opt) => {
          const row = document.createElement("div");
          row.className =
            "multi-select-option" +
            (selectedSchedules3.includes(opt) ? " selected" : "");
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = selectedSchedules3.includes(opt);
          checkbox.onchange = function (e) {
            if (this.checked) {
              if (!selectedSchedules3.includes(opt))
                selectedSchedules3.push(opt);
            } else {
              selectedSchedules3 = selectedSchedules3.filter((v) => v !== opt);
            }
            renderMultiSelectInput();
            renderMultiSelectDropdown();
          };
          const label = document.createElement("label");
          label.textContent = opt;
          row.appendChild(checkbox);
          row.appendChild(label);
          multiSelectDropdown.appendChild(row);
        });
      }

      function openMultiSelectDropdown() {
        multiSelectDropdown.style.display = "block";
        renderMultiSelectDropdown();
        multiSelect.classList.add("active");
      }
      function closeMultiSelectDropdown() {
        multiSelectDropdown.style.display = "none";
        multiSelect.classList.remove("active");
      }

      multiSelectInput.addEventListener("click", openMultiSelectDropdown);
      multiSelectInput.addEventListener("focus", openMultiSelectDropdown);
      multiSelectArrow.addEventListener("click", function (e) {
        e.stopPropagation();
        if (multiSelectDropdown.style.display === "block") {
          closeMultiSelectDropdown();
        } else {
          openMultiSelectDropdown();
        }
      });
      document.addEventListener("click", function (e) {
        if (!multiSelect.contains(e.target)) {
          closeMultiSelectDropdown();
        }
      });
      renderMultiSelectInput();

      // --- МУЛЬТИСЕЛЕКТ ДЛЯ РАБОЧИХ ЧАСОВ В ДЕНЬ ---
      const hoursOptions = [
        "4",
        "6",
        "8",
        "10",
        "12",
        "По договорённости",
        "Другое",
      ];
      let selectedHours = [];
      const hoursMultiSelect = document.getElementById("hours-multiselect");
      const hoursMultiSelectInput = document.getElementById(
        "hours-multiselect-input"
      );
      const hoursMultiSelectDropdown = document.getElementById(
        "hours-multiselect-dropdown"
      );
      const hoursMultiSelectArrow = document.getElementById(
        "hours-multiselect-arrow"
      );

      function renderHoursMultiSelectInput() {
        hoursMultiSelectInput.innerHTML = "";
        selectedHours.forEach((val) => {
          const tag = document.createElement("span");
          tag.className = "multi-select-tag";
          tag.textContent = val;
          const close = document.createElement("span");
          close.className = "multi-select-tag-close";
          close.innerHTML = "&times;";
          close.onclick = function (e) {
            e.stopPropagation();
            selectedHours = selectedHours.filter((v) => v !== val);
            renderHoursMultiSelectInput();
            renderHoursMultiSelectDropdown();
          };
          tag.appendChild(close);
          hoursMultiSelectInput.appendChild(tag);
        });
        if (selectedHours.length === 0) {
          const placeholder = document.createElement("span");
          placeholder.className = "multi-select-placeholder";
          placeholder.textContent = "Выберите из списка";
          hoursMultiSelectInput.appendChild(placeholder);
        }
      }

      function renderHoursMultiSelectDropdown() {
        hoursMultiSelectDropdown.innerHTML = "";
        hoursOptions.forEach((opt) => {
          const row = document.createElement("div");
          row.className =
            "multi-select-option" +
            (selectedHours.includes(opt) ? " selected" : "");
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = selectedHours.includes(opt);
          checkbox.onchange = function (e) {
            if (this.checked) {
              if (!selectedHours.includes(opt)) selectedHours.push(opt);
            } else {
              selectedHours = selectedHours.filter((v) => v !== opt);
            }
            renderHoursMultiSelectInput();
            renderHoursMultiSelectDropdown();
          };
          const label = document.createElement("label");
          label.textContent = opt;
          row.appendChild(checkbox);
          row.appendChild(label);
          hoursMultiSelectDropdown.appendChild(row);
        });
      }

      function openHoursMultiSelectDropdown() {
        hoursMultiSelectDropdown.style.display = "block";
        renderHoursMultiSelectDropdown();
        hoursMultiSelect.classList.add("active");
      }
      function closeHoursMultiSelectDropdown() {
        hoursMultiSelectDropdown.style.display = "none";
        hoursMultiSelect.classList.remove("active");
      }

      hoursMultiSelectInput.addEventListener(
        "click",
        openHoursMultiSelectDropdown
      );
      hoursMultiSelectInput.addEventListener(
        "focus",
        openHoursMultiSelectDropdown
      );
      hoursMultiSelectArrow.addEventListener("click", function (e) {
        e.stopPropagation();
        if (hoursMultiSelectDropdown.style.display === "block") {
          closeHoursMultiSelectDropdown();
        } else {
          openHoursMultiSelectDropdown();
        }
      });
      document.addEventListener("click", function (e) {
        if (!hoursMultiSelect.contains(e.target)) {
          closeHoursMultiSelectDropdown();
        }
      });
      renderHoursMultiSelectInput();

      // --- ПОКАЗ/СКРЫТИЕ ПОИСКА АДРЕСА ---
      document.addEventListener("DOMContentLoaded", function () {
        const addressRadios = document.querySelectorAll(
          'input[name="address-type"]'
        );
        const addressSearchBlock = document.getElementById(
          "address-search-block"
        );
        addressRadios.forEach((radio) => {
          radio.addEventListener("change", function () {
            if (addressRadios[1].checked) {
              addressSearchBlock.style.display = "block";
            } else {
              addressSearchBlock.style.display = "none";
            }
          });
        });
      });

      // --- ПОИСК И ПОДСКАЗКИ ПО АДРЕСАМ ---
      document.addEventListener("DOMContentLoaded", function () {
        const addressInput = document.querySelector(".address-search-input");
        const suggestionsList = document.getElementById("address-suggestions");
        const addressSearchIcon = document.querySelector(
          ".address-search-icon"
        );
        let debounceTimer;
        let focusedSuggestionIndex = -1;

        addressInput.addEventListener("input", () => {
          clearTimeout(debounceTimer);
          debounceTimer = setTimeout(() => {
            fetchAddressSuggestions(addressInput.value);
          }, 300);
        });

        async function fetchAddressSuggestions(query) {
          if (!query) {
            suggestionsList.classList.remove("visible");
            return;
          }
          try {
            const response = await fetch(
              `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(
                query + ", Грозный"
              )}&limit=10&addressdetails=1&countrycodes=ru&featuretype=house,building`
            );
            const data = await response.json();
            suggestionsList.innerHTML = "";
            focusedSuggestionIndex = -1;

            data.forEach((item) => {
              const address = item.address;
              const addressParts = [];

              // Добавляем улицу и номер дома
              if (address.road) {
                const streetPart = address.house_number
                  ? `${address.road}, ${address.house_number}`
                  : address.road;
                addressParts.push(streetPart);
              }

              // Добавляем район, если есть
              if (address.suburb) addressParts.push(address.suburb);

              // Добавляем город
              if (address.city) addressParts.push(address.city);
              else if (address.town) addressParts.push(address.town);

              const displayAddress = addressParts.join(", ");
              if (!displayAddress) return;

              const li = document.createElement("li");
              li.textContent = displayAddress;
              li.addEventListener("click", () => {
                addressInput.value = displayAddress;
                suggestionsList.classList.remove("visible");
              });
              suggestionsList.appendChild(li);
            });
            suggestionsList.classList.toggle("visible", data.length > 0);
          } catch (error) {
            console.error("Ошибка при получении адресов:", error);
          }
        }

        document.addEventListener("click", (e) => {
          if (
            !addressInput.contains(e.target) &&
            !suggestionsList.contains(e.target)
          ) {
            suggestionsList.classList.remove("visible");
          }
        });

        addressSearchIcon.addEventListener("click", function () {
          addressInput.focus();
        });
      });

      // --- МУЛЬТИСЕЛЕКТ ГОРОДА ---
      const cityOptions = [
        "Грозный",
        "Аргун",
        "Гудермес",
        "Урус-Мартан",
        "Шали",
      ];
      let selectedCities = [];
      const cityMultiSelect = document.getElementById("city-multiselect");
      const cityMultiSelectInput = document.getElementById(
        "city-multiselect-input"
      );
      const cityMultiSelectDropdown = document.getElementById(
        "city-multiselect-dropdown"
      );
      const cityMultiSelectArrow = document.getElementById(
        "city-multiselect-arrow"
      );

      function renderCityMultiSelectInput() {
        cityMultiSelectInput.innerHTML = "";
        selectedCities.forEach((val) => {
          const tag = document.createElement("span");
          tag.className = "multi-select-tag";
          tag.textContent = val;
          const close = document.createElement("span");
          close.className = "multi-select-tag-close";
          close.innerHTML = "&times;";
          close.onclick = function (e) {
            e.stopPropagation();
            selectedCities = selectedCities.filter((v) => v !== val);
            renderCityMultiSelectInput();
            renderCityMultiSelectDropdown();
          };
          tag.appendChild(close);
          cityMultiSelectInput.appendChild(tag);
        });
        if (selectedCities.length === 0) {
          const placeholder = document.createElement("span");
          placeholder.className = "multi-select-placeholder";
          placeholder.textContent = "Выберите из списка";
          cityMultiSelectInput.appendChild(placeholder);
        }
      }

      function renderCityMultiSelectDropdown() {
        cityMultiSelectDropdown.innerHTML = "";
        cityOptions.forEach((opt) => {
          const row = document.createElement("div");
          row.className =
            "multi-select-option" +
            (selectedCities.includes(opt) ? " selected" : "");
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = selectedCities.includes(opt);
          checkbox.onchange = function (e) {
            if (this.checked) {
              if (!selectedCities.includes(opt)) selectedCities.push(opt);
            } else {
              selectedCities = selectedCities.filter((v) => v !== opt);
            }
            renderCityMultiSelectInput();
            renderCityMultiSelectDropdown();
          };
          const label = document.createElement("label");
          label.textContent = opt;
          row.appendChild(checkbox);
          row.appendChild(label);
          cityMultiSelectDropdown.appendChild(row);
        });
      }

      function openCityMultiSelectDropdown() {
        cityMultiSelectDropdown.style.display = "block";
        renderCityMultiSelectDropdown();
        cityMultiSelect.classList.add("active");
      }

      function closeCityMultiSelectDropdown() {
        cityMultiSelectDropdown.style.display = "none";
        cityMultiSelect.classList.remove("active");
      }

      cityMultiSelectInput.addEventListener(
        "click",
        openCityMultiSelectDropdown
      );
      cityMultiSelectInput.addEventListener(
        "focus",
        openCityMultiSelectDropdown
      );
      cityMultiSelectArrow.addEventListener("click", function (e) {
        e.stopPropagation();
        if (cityMultiSelectDropdown.style.display === "block") {
          closeCityMultiSelectDropdown();
        } else {
          openCityMultiSelectDropdown();
        }
      });

      document.addEventListener("click", function (e) {
        if (!cityMultiSelect.contains(e.target)) {
          closeCityMultiSelectDropdown();
        }
      });

      renderCityMultiSelectInput();

      // Одиночный выбор для кнопок зарплаты
      document.querySelectorAll(".job-salary-type-group").forEach((group) => {
        group.addEventListener("click", function (e) {
          if (e.target.classList.contains("job-salary-type")) {
            group
              .querySelectorAll(".job-salary-type")
              .forEach((btn) => btn.classList.remove("active"));
            e.target.classList.add("active");
          }
        });
      });

      // Одиночный выбор для кнопок частоты выплат
      document.querySelectorAll(".job-salary-freq-group").forEach((group) => {
        group.addEventListener("click", function (e) {
          if (e.target.classList.contains("job-salary-freq")) {
            group
              .querySelectorAll(".job-salary-freq")
              .forEach((btn) => btn.classList.remove("active"));
            e.target.classList.add("active");
          }
        });
      });

      // Кастомный dropdown для валюты
      const currencyDropdown = document.querySelector(".currency-dropdown");
      const currencySelected = document.getElementById("currency-selected");
      const currencyList = document.getElementById("currency-list");
      currencySelected.addEventListener("click", function (e) {
        e.stopPropagation();
        currencyDropdown.classList.toggle("open");
        periodDropdown.classList.remove("open"); // Закрыть период при открытии валюты
      });
      currencyList.querySelectorAll(".dropdown-option").forEach((item) => {
        item.addEventListener("click", function (e) {
          currencyList
            .querySelectorAll(".dropdown-option")
            .forEach((i) => i.classList.remove("active"));
          this.classList.add("active");
          currencySelected.textContent = this.textContent;
          currencyDropdown.classList.remove("open");
        });
      });

      // Кастомный dropdown для периода
      const periodDropdown = document.querySelector(".period-dropdown");
      const periodSelected = document.getElementById("period-selected");
      const periodList = document.getElementById("period-list");
      periodSelected.addEventListener("click", function (e) {
        e.stopPropagation();
        periodDropdown.classList.toggle("open");
        currencyDropdown.classList.remove("open"); // Закрыть валюту при открытии периода
      });
      periodList.querySelectorAll(".dropdown-option").forEach((item) => {
        item.addEventListener("click", function (e) {
          periodList
            .querySelectorAll(".dropdown-option")
            .forEach((i) => i.classList.remove("active"));
          this.classList.add("active");
          periodSelected.textContent = this.textContent;
          periodDropdown.classList.remove("open");
        });
      });

      // Закрытие dropdown при клике вне
      document.addEventListener("click", function (e) {
        currencyDropdown.classList.remove("open");
        periodDropdown.classList.remove("open");
      });

      function openSpecItem(item) {
        const key = item.dataset.key;
        const children = specData[key]?.children;

        if (children) {
          item.classList.add("open");
          renderSpecChildren(key, children);
        }
      }

      function closeSpecItem(item) {
        item.classList.remove("open");
        const childrenContainer = document.getElementById(
          "modal-spec-children-container"
        );
        childrenContainer.innerHTML = "";
      }

      // Add click handlers for spec items
      document.querySelectorAll(".modal-spec-item").forEach((item) => {
        item.addEventListener("click", () => {
          const isOpen = item.classList.contains("open");
          if (isOpen) {
            closeSpecItem(item);
          } else {
            // Close any other open items first
            document
              .querySelectorAll(".modal-spec-item.open")
              .forEach((openItem) => {
                if (openItem !== item) {
                  closeSpecItem(openItem);
                }
              });
            openSpecItem(item);
          }
        });
      });

      // Логика для одного мини-редактора с не удаляемыми заголовками
      document.addEventListener("DOMContentLoaded", function () {
        const editor = document.getElementById("mini-editor");
        if (!editor) return;
        editor.addEventListener("keydown", function (e) {
          // Enter: добавить новую строку с дефисом после текущей строки, если не на заголовке
          if (e.key === "Enter") {
            const sel = window.getSelection();
            if (!sel.rangeCount) return;
            const range = sel.getRangeAt(0);
            const node = sel.anchorNode;
            const parent = node.nodeType === 3 ? node.parentElement : node;
            if (parent.classList.contains("editor-line")) {
              e.preventDefault();
              const newLine = document.createElement("div");
              newLine.className = "editor-line";
              newLine.setAttribute("contenteditable", "true");
              newLine.textContent = "— ";
              parent.after(newLine);
              // Переместить курсор в новую строку
              setTimeout(() => {
                newLine.focus();
                const range = document.createRange();
                range.selectNodeContents(newLine);
                range.collapse(false);
                const sel = window.getSelection();
                sel.removeAllRanges();
                sel.addRange(range);
              }, 0);
            } else if (parent.classList.contains("editor-section")) {
              e.preventDefault();
              // Перевести фокус на первую строку после заголовка
              const next = parent.nextElementSibling;
              if (next && next.classList.contains("editor-line")) {
                setTimeout(() => {
                  next.focus();
                  const range = document.createRange();
                  range.selectNodeContents(next);
                  range.collapse(false);
                  const sel = window.getSelection();
                  sel.removeAllRanges();
                  sel.addRange(range);
                }, 0);
              }
            }
          }
          // Не даём Backspace удалить заголовок
          if (e.key === "Backspace") {
            const sel = window.getSelection();
            if (!sel.rangeCount) return;
            const node = sel.anchorNode;
            const parent = node.nodeType === 3 ? node.parentElement : node;
            if (parent.classList.contains("editor-section")) {
              e.preventDefault();
              // Перевести фокус на первую строку после заголовка
              const next = parent.nextElementSibling;
              if (next && next.classList.contains("editor-line")) {
                setTimeout(() => {
                  next.focus();
                  const range = document.createRange();
                  range.selectNodeContents(next);
                  range.collapse(false);
                  const sel = window.getSelection();
                  sel.removeAllRanges();
                  sel.addRange(range);
                }, 0);
              }
            }
            // Если строка пустая — удаляем её, но не если это единственная под секцией
            if (
              parent.classList.contains("editor-line") &&
              parent.textContent.replace("—", "").trim() === ""
            ) {
              const prev = parent.previousElementSibling;
              const next = parent.nextElementSibling;
              if (prev && prev.classList.contains("editor-section")) {
                // Считаем количество editor-line между этим заголовком и следующим
                let count = 0;
                let el = parent;
                while (el && el.classList.contains("editor-line")) {
                  count++;
                  el = el.previousElementSibling;
                  if (el && el.classList.contains("editor-section")) break;
                }
                // Если это единственная строка под секцией — не удаляем
                if (count <= 1) {
                  e.preventDefault();
                  return;
                }
              }
              parent.remove();
              e.preventDefault();
              // После удаления фокус на предыдущую строку или следующую
              if (prev && prev.classList.contains("editor-line")) {
                setTimeout(() => {
                  prev.focus();
                  const range = document.createRange();
                  range.selectNodeContents(prev);
                  range.collapse(false);
                  const sel = window.getSelection();
                  sel.removeAllRanges();
                  sel.addRange(range);
                }, 0);
              } else if (next && next.classList.contains("editor-line")) {
                setTimeout(() => {
                  next.focus();
                  const range = document.createRange();
                  range.selectNodeContents(next);
                  range.collapse(false);
                  const sel = window.getSelection();
                  sel.removeAllRanges();
                  sel.addRange(range);
                }, 0);
              }
            }
          }
          // Tab/Shift+Tab: переход между строками, не даём фокусироваться на заголовках
          if (e.key === "Tab") {
            const sel = window.getSelection();
            if (!sel.rangeCount) return;
            const node = sel.anchorNode;
            const parent = node.nodeType === 3 ? node.parentElement : node;
            if (parent.classList.contains("editor-section")) {
              e.preventDefault();
              const next = parent.nextElementSibling;
              if (next && next.classList.contains("editor-line")) {
                setTimeout(() => {
                  next.focus();
                }, 0);
              }
            }
          }
        });
        // Автоматически добавлять дефис в начале строки
        editor.addEventListener("input", function (e) {
          document.querySelectorAll(".editor-line").forEach((line) => {
            if (!line.textContent.startsWith("—")) {
              line.textContent =
                "— " + line.textContent.replace(/^[-—\s]+/, "");
            }
          });
        });
      });

      // --- МУЛЬТИСЕЛЕКТ ДЛЯ НАВЫКОВ ---
      const skillsOptions = [
        "Python",
        "Django",
        "PostgreSQL",
        "Git",
        "Командная работа",
        "Продажи",
        "MS Office",
        "Коммуникация",
        "Переговоры",
        "React",
        "TypeScript",
        "HTML",
        "CSS",
        "REST API",
        "Adobe Photoshop",
        "Illustrator",
        "Брендинг",
        "Креативность",
        "1С",
        "Бухгалтерский учет",
        "Налоговая отчетность",
        "Digital-маркетинг",
        "Google Analytics",
        "Аналитика",
        "Обслуживание клиентов",
        "Ответственность",
        "Linux",
        "Windows",
        "Сетевые протоколы",
        "Безопасность",
        "Рекрутинг",
        "Трудовое законодательство",
        "Водительские навыки",
        "Клиентоориентированность",
        "Копирайтинг",
        "SEO",
        "Грамотность",
        "Кулинария",
        "Санитарные нормы",
      ];
      let selectedSkills = [];
      let skillsSearch = "";
      const skillsMultiSelect = document.getElementById("skills-multiselect");
      const skillsMultiSelectInput = document.getElementById(
        "skills-multiselect-input"
      );
      const skillsMultiSelectDropdown = document.getElementById(
        "skills-multiselect-dropdown"
      );
      const skillsMultiSelectArrow = document.getElementById(
        "skills-multiselect-arrow"
      );

      function renderSkillsMultiSelectInput() {
        skillsMultiSelectInput.innerHTML = "";
        selectedSkills.forEach((val) => {
          const tag = document.createElement("span");
          tag.className = "multi-select-tag";
          tag.textContent = val;
          const close = document.createElement("span");
          close.className = "multi-select-tag-close";
          close.innerHTML = "&times;";
          close.onclick = function (e) {
            e.stopPropagation();
            selectedSkills = selectedSkills.filter((v) => v !== val);
            renderSkillsMultiSelectInput();
            renderSkillsMultiSelectDropdown();
          };
          tag.appendChild(close);
          skillsMultiSelectInput.appendChild(tag);
        });
        // Инпут для поиска
        if (selectedSkills.length < 15) {
          const input = document.createElement("input");
          input.type = "text";
          input.className = "multi-select-search";
          input.placeholder =
            selectedSkills.length === 0
              ? "Найдите или напишите свой вариант"
              : "";
          input.value = skillsSearch;
          input.oninput = function (e) {
            skillsSearch = this.value;
            renderSkillsMultiSelectDropdown();
          };
          input.onkeydown = function (e) {
            if (e.key === "Enter" && skillsSearch.trim()) {
              e.preventDefault();
              addSkillFromSearch();
            }
            if (
              e.key === "Backspace" &&
              !skillsSearch &&
              selectedSkills.length > 0
            ) {
              // Удалить последний навык по Backspace
              selectedSkills.pop();
              renderSkillsMultiSelectInput();
              renderSkillsMultiSelectDropdown();
            }
          };
          skillsMultiSelectInput.appendChild(input);
          setTimeout(() => input.focus(), 0);
        }
      }

      function addSkillFromSearch() {
        const filter = skillsSearch.trim();
        if (!filter) return;
        // Если найден точный навык
        const found = skillsOptions.find(
          (opt) => opt.toLowerCase() === filter.toLowerCase()
        );
        if (found && !selectedSkills.includes(found)) {
          selectedSkills.push(found);
        } else if (!selectedSkills.includes(filter)) {
          selectedSkills.push(filter);
        }
        skillsSearch = "";
        renderSkillsMultiSelectInput();
        renderSkillsMultiSelectDropdown();
      }

      function renderSkillsMultiSelectDropdown() {
        skillsMultiSelectDropdown.innerHTML = "";
        let filter = skillsSearch.trim();
        let filtered = skillsOptions.filter((opt) =>
          opt.toLowerCase().includes(filter.toLowerCase())
        );
        filtered = filtered.filter((opt) => !selectedSkills.includes(opt));
        filtered.slice(0, 20).forEach((opt) => {
          const row = document.createElement("div");
          row.className = "multi-select-option";
          row.textContent = opt;
          row.onclick = function () {
            if (selectedSkills.length < 15) {
              selectedSkills.push(opt);
              skillsSearch = "";
              renderSkillsMultiSelectInput();
              renderSkillsMultiSelectDropdown();
            }
          };
          skillsMultiSelectDropdown.appendChild(row);
        });
        // Если ничего не найдено — можно добавить свой вариант
        if (
          filter &&
          !skillsOptions.some(
            (opt) => opt.toLowerCase() === filter.toLowerCase()
          ) &&
          !selectedSkills.includes(filter)
        ) {
          const addRow = document.createElement("div");
          addRow.className = "multi-select-option";
          addRow.innerHTML =
            '<span style="color:#2563eb;">+ Добавить: </span>' + filter;
          addRow.onclick = function () {
            if (selectedSkills.length < 15) {
              selectedSkills.push(filter);
              skillsSearch = "";
              renderSkillsMultiSelectInput();
              renderSkillsMultiSelectDropdown();
            }
          };
          skillsMultiSelectDropdown.appendChild(addRow);
        }
        if (
          filtered.length > 0 ||
          (filter &&
            !skillsOptions.some(
              (opt) => opt.toLowerCase() === filter.toLowerCase()
            ))
        ) {
          skillsMultiSelectDropdown.style.display = "block";
        } else {
          skillsMultiSelectDropdown.style.display = "none";
        }
      }

      function openSkillsMultiSelectDropdown() {
        skillsMultiSelectDropdown.style.display = "block";
        renderSkillsMultiSelectDropdown();
        skillsMultiSelect.classList.add("active");
        // Фокус на input
        const input = skillsMultiSelectInput.querySelector("input");
        if (input) setTimeout(() => input.focus(), 0);
      }
      function closeSkillsMultiSelectDropdown() {
        skillsMultiSelectDropdown.style.display = "none";
        skillsMultiSelect.classList.remove("active");
      }

      skillsMultiSelectInput.addEventListener(
        "click",
        openSkillsMultiSelectDropdown
      );
      skillsMultiSelectInput.addEventListener(
        "focus",
        openSkillsMultiSelectDropdown
      );
      skillsMultiSelectArrow.addEventListener("click", function (e) {
        e.stopPropagation();
        if (skillsMultiSelectDropdown.style.display === "block") {
          closeSkillsMultiSelectDropdown();
        } else {
          openSkillsMultiSelectDropdown();
        }
      });
      document.addEventListener("click", function (e) {
        if (!skillsMultiSelect.contains(e.target)) {
          closeSkillsMultiSelectDropdown();
        }
      });
      renderSkillsMultiSelectInput();

      // --- Подстановка контактных данных из аккаунта ---
      document.addEventListener("DOMContentLoaded", function () {
        const user = JSON.parse(localStorage.getItem("currentUser") || "{}");
        document.getElementById("contact-name").textContent = user.name || "";
        document.getElementById("contact-email").textContent = user.email || "";
        document.getElementById("contact-phone").textContent = user.phone || "";
      });

      // --- Подстановка и редактирование дополнительных контактов ---
      document.addEventListener("DOMContentLoaded", function () {
        const user = JSON.parse(localStorage.getItem("currentUser") || "{}");
        document.getElementById("contact-name").textContent = user.name || "";
        document.getElementById("contact-email").textContent = user.email || "";
        document.getElementById("contact-phone").textContent = user.phone || "";

        // Универсальная функция для блока
        function renderContactField(blockId, value, label, type) {
          const block = document.getElementById(blockId);
          block.innerHTML = "";
          if (type === "telegram" || type === "whatsapp") {
            let icon =
              type === "telegram"
                ? `<span class="contact-messenger-icon">${telegramSVG()}</span>`
                : `<span class="contact-messenger-icon">${whatsappSVG()}</span>`;
            let wrapClass =
              type === "telegram"
                ? "contact-messenger contact-telegram"
                : "contact-messenger contact-whatsapp";
            let text = value
              ? `<span class="contact-messenger-text">${value}</span>`
              : `<span class="contact-messenger-placeholder">Указать ${label}</span>`;
            block.innerHTML = `<div class="${wrapClass}" tabindex="0">${icon}${text}</div>`;
            const container = block.querySelector("div");
            container.onclick = function (e) {
              e.stopPropagation();
              editMessengerInline(blockId, label, type, value);
            };
          } else {
            block.innerHTML = value ? value : "";
          }
        }
        // Inline редактирование для мессенджеров
        window.editMessengerInline = function (blockId, label, type, value) {
          const block = document.getElementById(blockId);
          let icon =
            type === "telegram"
              ? `<span class=\"contact-messenger-icon\">${telegramSVG()}</span>`
              : `<span class=\"contact-messenger-icon\">${whatsappSVG()}</span>`;
          let wrapClass =
            type === "telegram"
              ? "contact-messenger contact-telegram"
              : "contact-messenger contact-whatsapp";
          block.innerHTML = `<div class=\"${wrapClass}\">${icon}<input class='contact-messenger-edit' id='edit-${blockId}' placeholder='${label}' value='${
            value ? value : ""
          }'></div>`;
          const input = document.getElementById("edit-" + blockId);
          input.focus();
          input.onkeydown = function (e) {
            if (e.key === "Enter") {
              saveMessengerInline(blockId, label, type);
            }
          };
          input.onblur = function () {
            saveMessengerInline(blockId, label, type);
          };
        };
        window.saveMessengerInline = function (blockId, label, type) {
          const input = document.getElementById("edit-" + blockId);
          if (!input) return;
          const value = input.value.trim();
          let user = JSON.parse(localStorage.getItem("currentUser") || "{}");
          if (type === "telegram") user.telegram = value;
          if (type === "whatsapp") user.whatsapp = value;
          localStorage.setItem("currentUser", JSON.stringify(user));
          renderAllContacts();
        };
        function renderAllContacts() {
          const user = JSON.parse(localStorage.getItem("currentUser") || "{}");
          renderContactField(
            "contact-phone2-block",
            user.phone2,
            "номер",
            "phone2"
          );
          renderContactField(
            "contact-telegram-block",
            user.telegram,
            "Telegram",
            "telegram"
          );
          renderContactField(
            "contact-whatsapp-block",
            user.whatsapp,
            "WhatsApp",
            "whatsapp"
          );
        }
        renderAllContacts();
      });

      // SVG-иконки
      function telegramSVG() {
        return `<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="11" fill="#229ED9"/><path d="M6.5 11.5l3.1 2.3c.2.1.5.1.6-.1l4-5.2" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M6.5 11.5l8-3.2c.3-.1.6.2.5.5l-1.5 7.2c-.1.3-.4.4-.7.3l-2.1-.8" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>`;
      }
      function whatsappSVG() {
        return `<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="11" fill="#25D366"/><path d="M7.5 13.5c1.2 1.2 3.2 1.7 4.2 1.2.3-.2.7-.7.9-1.1.1-.2.1-.4-.1-.6l-.7-.7c-.2-.2-.5-.2-.7 0l-.3.3c-.2.2-.5.2-.7 0l-1.2-1.2c-.2-.2-.2-.5 0-.7l.3-.3c.2-.2.2-.5 0-.7l-.7-.7c-.2-.2-.4-.2-.6-.1-.4.2-.9.6-1.1.9-.5 1 .1 3 1.3 4.2z" stroke="#fff" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>`;
      }

      // --- Режимы просмотра и редактирования контактов ---
      function showContactEditMode(edit) {
        document.getElementById("contact-card-view").style.display = edit
          ? "none"
          : "";
        document.getElementById("contact-card-edit").style.display = edit
          ? ""
          : "none";
      }
      document.addEventListener("DOMContentLoaded", function () {
        // ... предыдущий код ...
        // Кнопка редактирования
        document.getElementById("contact-edit-btn").onclick = function () {
          const user = JSON.parse(localStorage.getItem("currentUser") || "{}");
          document.getElementById("edit-contact-name").value = user.name || "";
          document.getElementById("edit-contact-email").value =
            user.email || "";
          document.getElementById("edit-contact-phone").value =
            user.phone || "";
          document.getElementById("edit-contact-phone-comment").value =
            user.phoneComment || "";
          document.getElementById("edit-contact-telegram").value =
            user.telegram || "";
          document.getElementById("edit-contact-whatsapp").value =
            user.whatsapp || "";
          // Второй номер
          renderPhone2Edit(user.phone2 || "", user.phone2Comment || "");
          showContactEditMode(true);
        };
        document.getElementById("contact-cancel-btn").onclick = function () {
          showContactEditMode(false);
        };
        document.getElementById("contact-card-edit").onsubmit = function (e) {
          e.preventDefault();
          let user = JSON.parse(localStorage.getItem("currentUser") || "{}");
          user.name = document.getElementById("edit-contact-name").value.trim();
          user.email = document
            .getElementById("edit-contact-email")
            .value.trim();
          user.phone = document
            .getElementById("edit-contact-phone")
            .value.trim();
          user.phoneComment = document
            .getElementById("edit-contact-phone-comment")
            .value.trim();
          user.telegram = document
            .getElementById("edit-contact-telegram")
            .value.trim();
          user.whatsapp = document
            .getElementById("edit-contact-whatsapp")
            .value.trim();
          // Второй номер
          const phone2 = document.getElementById("edit-contact-phone2");
          const phone2Comment = document.getElementById(
            "edit-contact-phone2-comment"
          );
          user.phone2 = phone2 ? phone2.value.trim() : "";
          user.phone2Comment = phone2Comment ? phone2Comment.value.trim() : "";
          localStorage.setItem("currentUser", JSON.stringify(user));
          showContactEditMode(false);
          renderAllContacts();
        };
        // Добавить второй номер
        document.getElementById("add-phone2-btn").onclick = function () {
          renderPhone2Edit("", "");
          this.style.display = "none";
        };
        function renderPhone2Edit(val, comment) {
          const row = document.getElementById("edit-phone2-row");
          row.innerHTML = `<div class='contact-edit-row'><label class='contact-edit-label' style='flex:1;'>Телефон<input class='contact-edit-input' id='edit-contact-phone2' type='text' value='${
            val || ""
          }' autocomplete='off'></label><label class='contact-edit-label' style='flex:1;'>Комментарий<input class='contact-edit-input' id='edit-contact-phone2-comment' type='text' value='${
            comment || ""
          }' autocomplete='off' placeholder='Комментарий'></label></div>`;
          document.getElementById("add-phone2-btn").style.display = "none";
        }
      });

      // --- Инлайн-редактирование контактов ---
      let contactEditMode = false;
      function renderContactBlock() {
        const user = JSON.parse(localStorage.getItem("currentUser") || "{}");
        const info = document.getElementById("contact-info-block");
        const actions = document.getElementById("contact-actions-block");
        info.innerHTML = "";
        actions.innerHTML = "";
        if (!contactEditMode) {
          // Просмотр
          info.innerHTML += `<div class='contact-item'><b>${
            user.name || ""
          }</b></div>`;
          info.innerHTML += `<div class='contact-item'>${
            user.email || ""
          }</div>`;
          info.innerHTML += `<div class='contact-item'>${
            user.phone || ""
          }</div>`;
          info.innerHTML += `<div class='contact-messengers-row'>
          <div class='contact-messenger contact-telegram'>
            <span class='contact-messenger-icon'>${telegramSVG()}</span>
            <span class='contact-messenger-text'>${
              user.telegram ||
              "<span class='contact-messenger-placeholder'>Указать Telegram</span>"
            }</span>
          </div>
          <div class='contact-messenger contact-whatsapp'>
            <span class='contact-messenger-icon'>${whatsappSVG()}</span>
            <span class='contact-messenger-text'>${
              user.whatsapp ||
              "<span class='contact-messenger-placeholder'>Указать WhatsApp</span>"
            }</span>
          </div>
        </div>`;
          actions.innerHTML = `<button class='contact-edit-btn' id='contact-edit-btn'>Редактировать</button>`;
          document.getElementById("contact-edit-btn").onclick = function () {
            contactEditMode = true;
            renderContactBlock();
          };
        } else {
          // Редактирование
          info.innerHTML += `<input type='text' id='edit-contact-name' value='${
            user.name || ""
          }' placeholder='Имя и фамилия'>`;
          info.innerHTML += `<input type='email' id='edit-contact-email' value='${
            user.email || ""
          }' placeholder='Почта'>`;
          info.innerHTML += `<input type='text' id='edit-contact-phone' value='${
            user.phone || ""
          }' placeholder='Телефон'>`;
          info.innerHTML += `<div class='contact-messengers-row'>
          <div class='contact-messenger contact-telegram'>
            <span class='contact-messenger-icon'>${telegramSVG()}</span>
            <input class='contact-messenger-edit' id='edit-contact-telegram' type='text' value='${
              user.telegram || ""
            }' placeholder='Telegram'>
          </div>
          <div class='contact-messenger contact-whatsapp'>
            <span class='contact-messenger-icon'>${whatsappSVG()}</span>
            <input class='contact-messenger-edit' id='edit-contact-whatsapp' type='text' value='${
              user.whatsapp || ""
            }' placeholder='WhatsApp'>
          </div>
        </div>`;
          actions.innerHTML = `<div class='contact-inline-actions'><button class='contact-inline-btn' id='contact-save-btn'>Сохранить</button><button class='contact-inline-btn cancel' id='contact-cancel-btn'>Отмена</button></div>`;

          document.getElementById("contact-save-btn").onclick = function () {
            let user = JSON.parse(localStorage.getItem("currentUser") || "{}");
            user.name = document
              .getElementById("edit-contact-name")
              .value.trim();
            user.email = document
              .getElementById("edit-contact-email")
              .value.trim();
            user.phone = document
              .getElementById("edit-contact-phone")
              .value.trim();
            user.telegram = document
              .getElementById("edit-contact-telegram")
              .value.trim();
            user.whatsapp = document
              .getElementById("edit-contact-whatsapp")
              .value.trim();
            localStorage.setItem("currentUser", JSON.stringify(user));
            contactEditMode = false;
            renderContactBlock();
          };
          document.getElementById("contact-cancel-btn").onclick = function () {
            contactEditMode = false;
            renderContactBlock();
          };
        }
      }
      document.addEventListener("DOMContentLoaded", function () {
        renderContactBlock();
      });

      // Форматирование чисел в полях зарплаты
      function formatNumber(input) {
        // Удаляем все нецифровые символы
        let value = input.value.replace(/\D/g, "");

        // Форматируем число, добавляя пробелы между тысячами
        if (value.length > 0) {
          value = value.replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        }

        // Обновляем значение поля
        input.value = value;
      }

      // Применяем форматирование к полям ввода зарплаты
      document.addEventListener("DOMContentLoaded", function () {
        const salaryInputs = document.querySelectorAll(".job-salary-input");
        salaryInputs.forEach((input) => {
          input.addEventListener("input", function () {
            formatNumber(this);
          });
        });
      });

      // Валидация полей при публикации
      document.addEventListener("DOMContentLoaded", function () {
        const publishBtn = document.querySelector(".publish-btn");

        publishBtn.addEventListener("click", function () {
          // Список обязательных полей
          const requiredFields = [
            {
              selector: 'input[placeholder="Название вакансии"]',
              label: "Название",
            },
            {
              selector: "#specialization-input",
              label: "Специализация сотрудника",
            },
            { selector: "#schedule-multiselect", label: "График работы" },
            { selector: "#hours-multiselect", label: "Рабочие часы в день" },
            { selector: "#city-multiselect", label: "Город публикации" },
            { selector: "#mini-editor", label: "Описание вакансии" },
          ];

          let firstInvalidField = null;

          // Проверяем каждое поле
          requiredFields.forEach((field) => {
            const element = document.querySelector(field.selector);
            let parent;

            // Определяем родительский элемент в зависимости от типа поля
            if (field.selector.includes("multiselect")) {
              parent = element.querySelector(".multi-select-input");
            } else if (field.selector === "#mini-editor") {
              parent = element;
            } else {
              parent = element;
            }

            // Проверяем заполненность
            let isEmpty = false;

            if (field.selector === "#mini-editor") {
              // Для редактора проверяем наличие текста
              const editorLines = element.querySelectorAll(".editor-line");
              isEmpty = true;
              editorLines.forEach((line) => {
                // Проверяем, есть ли текст кроме дефиса и пробелов
                if (line.textContent.replace(/[—\s]/g, "").length > 0) {
                  isEmpty = false;
                }
              });
            } else if (field.selector.includes("multiselect")) {
              // Для мультиселектов проверяем наличие выбранных значений
              isEmpty = !parent.querySelector(".multi-select-tag");
            } else {
              // Для обычных инпутов
              isEmpty = !element.value.trim();
            }

            if (isEmpty) {
              // Добавляем красную рамку
              parent.style.borderColor = "#ef4444";
              parent.style.transition = "border-color 0.2s ease";

              // Запоминаем первое незаполненное поле для прокрутки
              if (!firstInvalidField) {
                firstInvalidField = parent;
              }
            } else {
              // Возвращаем обычную рамку
              parent.style.borderColor = "#d1d5db";
            }
          });

          // Если есть незаполненные поля, прокручиваем к первому
          if (firstInvalidField) {
            firstInvalidField.scrollIntoView({
              behavior: "smooth",
              block: "center",
            });
          }
        });

        // Убираем красную рамку при фокусе на поле
        requiredFields.forEach((field) => {
          const element = document.querySelector(field.selector);
          let parent;

          if (field.selector.includes("multiselect")) {
            parent = element.querySelector(".multi-select-input");
            parent.addEventListener("focus", function () {
              this.style.borderColor = "#d1d5db";
            });
          } else if (field.selector === "#mini-editor") {
            parent = element;
            element.addEventListener("focus", function () {
              this.style.borderColor = "#d1d5db";
            });
          } else {
            parent = element;
            element.addEventListener("focus", function () {
              this.style.borderColor = "#d1d5db";
            });
          }
        });
      });

      document.addEventListener("DOMContentLoaded", function () {
        // Активация кнопок по умолчанию
        const sections = document.querySelectorAll(".create-job-section");

        sections.forEach((section) => {
          const title = section.querySelector(".section-title");
          if (title) {
            if (title.textContent === "Основная информация") {
              const experienceButtons = section.querySelector(".cj-btn-group");
              if (experienceButtons) {
                const noExperienceBtn =
                  experienceButtons.querySelector(".cj-btn");
                if (noExperienceBtn) {
                  noExperienceBtn.classList.add("active");
                }
              }
            }
            if (title.textContent === "Условия работы") {
              const employmentButtons = section.querySelector(".cj-btn-group");
              if (employmentButtons) {
                const fullTimeBtn = employmentButtons.querySelector(".cj-btn");
                if (fullTimeBtn) {
                  fullTimeBtn.classList.add("active");
                }
              }
            }
          }
        });

        // Остальной код...
      });

      window.addEventListener("scroll", function () {
        const header = document.querySelector(".cursor-header");
        if (window.scrollY > 10) {
          header.classList.add("scrolled");
        } else {
          header.classList.remove("scrolled");
        }
      });

      // --- МОДАЛЬНОЕ ОКНО СПЕЦИАЛИЗАЦИИ: КАСТОМНЫЕ RADIO ---
      function renderSpecChildrenBlock(professions, selectedSpec) {
        // Возвращает HTML для подсписка профессий с кастомными radio
        return professions
          .map(
            (prof) => `
        <label class="job-radio" style="font-size:15px;">
          <input type="radio" name="spec-profession" value="${prof}" ${
              selectedSpec === prof ? "checked" : ""
            }>
          <span class="job-radio-custom"></span>
          ${prof}
        </label>
      `
          )
          .join("");
      }

      // Переопределяем обработчик для открытия подкатегорий
      // ... существующий код ...
      document.addEventListener("DOMContentLoaded", function () {
        // ... существующий код ...
        const professions = {
          /* ... */
        }; // уже определён выше
        let selectedSpec = "";
        // ...
        document.querySelectorAll(".modal-spec-item").forEach((item) => {
          item.addEventListener("click", function (e) {
            e.stopPropagation();
            const key = this.getAttribute("data-key");
            // ...
            if (openedKeys.has(key)) {
              // ...
              return;
            }
            openedKeys.add(key);
            this.classList.add("open");
            this.querySelector(".modal-spec-arrow svg").style.transform =
              "rotate(90deg)";
            if (professions[key]) {
              const childrenBlock = document.createElement("div");
              childrenBlock.className = "modal-spec-children-block";
              childrenBlock.innerHTML = renderSpecChildrenBlock(
                professions[key],
                selectedSpec
              );
              this.after(childrenBlock);
              // Навешиваем обработчик на radio
              childrenBlock
                .querySelectorAll("input[type=radio]")
                .forEach((radio) => {
                  radio.addEventListener("change", function () {
                    document
                      .querySelectorAll('input[name="spec-profession"]')
                      .forEach((r) => {
                        if (r !== this) r.checked = false;
                      });
                    selectedSpec = this.value;
                  });
                });
            }
          });
        });
        // ...
        // Поиск по специализациям и профессиям (заменяем radio на кастомные)
        specSearchInput.addEventListener("input", function () {
          // ...
          if (searchText) {
            // ...
            Object.entries(professions).forEach(([categoryKey, profs]) => {
              profs.forEach((prof) => {
                if (prof.toLowerCase().includes(searchText)) {
                  hasResults = true;
                  const label = document.createElement("label");
                  label.className = "job-radio";
                  label.innerHTML = `<input type="radio" name="spec-profession-search" value="${prof}" ${
                    selectedSpec === prof ? "checked" : ""
                  }><span class="job-radio-custom"></span> ${prof}`;
                  searchResults.appendChild(label);
                }
              });
            });
            // ...
            searchResults
              .querySelectorAll("input[type=radio]")
              .forEach((radio) => {
                radio.addEventListener("change", function () {
                  selectedSpec = this.value;
                });
              });
          }
          // ...
        });
      });
      // ... existing code ...
    </script>

    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
      // Map variables
      let mapSelect = null;
      let selectedMarker = null;
      let selectedCoordinates = null;
      let selectedAddress = "";

      function openMapSelectModal() {
        const modal = document.getElementById("map-select-modal");
        const modalContent = modal.querySelector(".modal-content");
        modal.style.display = "flex";
        setTimeout(() => modalContent.classList.add("active"), 10);

        // Если карта уже инициализирована, просто показать и обновить маркер
        if (mapSelect) {
          mapSelect.invalidateSize();
          if (selectedCoordinates) {
            if (!selectedMarker) {
              selectedMarker = L.marker([
                selectedCoordinates.lat,
                selectedCoordinates.lng,
              ])
                .addTo(mapSelect)
                .bindPopup(selectedAddress || "Определение адреса...")
                .openPopup();
            } else {
              selectedMarker.setLatLng([
                selectedCoordinates.lat,
                selectedCoordinates.lng,
              ]);
              selectedMarker.setPopupContent(
                selectedAddress || "Определение адреса..."
              );
              selectedMarker.openPopup();
            }
            mapSelect.setView(
              [selectedCoordinates.lat, selectedCoordinates.lng],
              15
            );
          }
          return;
        }

        // Инициализация карты
        mapSelect = L.map("map-select", {
          center: selectedCoordinates
            ? [selectedCoordinates.lat, selectedCoordinates.lng]
            : [43.3178, 45.6949],
          zoom: selectedCoordinates ? 15 : 13,
          zoomControl: true,
        });

        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution:
            '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        }).addTo(mapSelect);

        // Если координаты уже есть, ставим маркер
        if (selectedCoordinates) {
          selectedMarker = L.marker([
            selectedCoordinates.lat,
            selectedCoordinates.lng,
          ])
            .addTo(mapSelect)
            .bindPopup(selectedAddress || "Определение адреса...")
            .openPopup();
          mapSelect.setView(
            [selectedCoordinates.lat, selectedCoordinates.lng],
            15
          );
        }

        mapSelect.on("click", function (e) {
          const { lat, lng } = e.latlng;
          selectedCoordinates = { lat, lng };
          selectedAddress = "";
          // Мгновенно ставим/перемещаем маркер
          if (selectedMarker) {
            selectedMarker.setLatLng([lat, lng]);
            selectedMarker.setPopupContent("Определение адреса...");
          } else {
            selectedMarker = L.marker([lat, lng])
              .addTo(mapSelect)
              .bindPopup("Определение адреса...")
              .openPopup();
          }
          selectedMarker.openPopup();
          // Асинхронно получаем адрес
          fetch(
            `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`
          )
            .then((response) => response.json())
            .then((data) => {
              const addressParts = [];
              if (data.address.road) addressParts.push(data.address.road);
              if (data.address.house_number)
                addressParts.push(data.address.house_number);
              addressParts.push("Грозный");
              const displayAddress = addressParts.join(", ") || "Грозный";
              selectedAddress = displayAddress;
              selectedMarker.setPopupContent(displayAddress);
              selectedMarker.openPopup();
            })
            .catch(() => {
              selectedAddress = "";
              selectedMarker.setPopupContent("Не удалось определить адрес");
              selectedMarker.openPopup();
            });
        });

        setTimeout(() => mapSelect.invalidateSize(), 300);
      }

      function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        const modalContent = modal.querySelector(".modal-content");
        modalContent.classList.remove("active");
        setTimeout(() => {
          modal.style.display = "none";
        }, 300);
      }

      function saveSelectedLocation() {
        if (selectedMarker && selectedAddress) {
          const addressInput = document.querySelector(".address-search-input");
          addressInput.value = selectedAddress;
          closeModal("map-select-modal");
        }
      }
    </script>
  </body>
</html>
<!-- Стили для create-job будут добавлены в styles.css -->
